"use strict";function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}function _classCallCheck(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function _defineProperties(t,e){for(var i=0;i<e.length;i++){var s=e[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(t,_toPropertyKey(s.key),s)}}function _createClass(t,e,i){return e&&_defineProperties(t.prototype,e),i&&_defineProperties(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function _toPropertyKey(t){var e=_toPrimitive(t,"string");return"symbol"===_typeof(e)?e:String(e)}function _toPrimitive(t,e){if("object"!==_typeof(t)||null===t)return t;var i=t[Symbol.toPrimitive];if(void 0!==i){var s=i.call(t,e||"default");if("object"!==_typeof(s))return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===e?String:Number)(t)}var JustQuiz=function(){function t(e,i){_classCallCheck(this,t),this.selector=e;var s={fadeTime:300,stepperBtnClass:null};Object.defineProperties(s,{_startPage:{get:function(){return 1}}}),this.options=Object.assign(s,i),this.quiz=document.querySelector(e),this.quiz&&(this.stepsNode=this.quiz.querySelector(".just-quiz__steps"),this.controlsNode=this.quiz.querySelector(".just-quiz__controls"),this.screenNodes=this.quiz.querySelectorAll("[data-quiz-screen]"),this.quizScreenCount=this.screenNodes.length),this.initQuiz()}return _createClass(t,[{key:"initScreens",value:function(){var t=this;return this.quizScreenCount>1&&(this.screenNodes.forEach((function(e,i){e.dataset.quizScreen=i+1,e.style.setProperty("--just-quiz-fade-time","".concat(t.options.fadeTime/1e3,"s"))})),!0)}},{key:"initSteps",value:function(){if(this.stepsNode&&this.quizScreenCount>1){var t='<span data-quiz-step="current">1</span> / <span data-quiz-step="all">'.concat(this.quizScreenCount,"</span>");this.stepsNode.insertAdjacentHTML("afterbegin",t)}}},{key:"initControls",value:function(){var t=this;if(this.controlsNode&&this.quizScreenCount>1){this.controlsNode.insertAdjacentHTML("afterbegin",'<button class="just-quiz__stepper just-quiz__stepper--prev" type="button" data-quiz-stepper="prev">Назад</button>\n      <button class="just-quiz__stepper just-quiz__stepper--next" type="button" data-quiz-stepper="next">Далее</button>\n      <button class="just-quiz__stepper just-quiz__stepper--submit" type="submit">Отправить</button>'),this.options.stepperBtnClass&&Array.from(this.controlsNode.children).forEach((function(e){return e.classList.add(t.options.stepperBtnClass)}));var e=this.controlsNode.querySelector('[data-quiz-stepper="prev"]');this.controlsNode.querySelector('[data-quiz-stepper="next"]').addEventListener("click",(function(){return t.incrementPage()})),e.addEventListener("click",(function(){return t.decrementPage()}))}}},{key:"incrementPage",value:function(){var t=Number(this.quiz.dataset.quizPage)+1;this.quiz.dataset.quizPage=t,this.setScreen(t)}},{key:"decrementPage",value:function(){var t=Number(this.quiz.dataset.quizPage)-1;this.quiz.dataset.quizPage=t,this.setScreen(t)}},{key:"setScreen",value:function(t){t<1||t>this.quizScreenCount||(this.updateStepper(t),this.updateQuizStateClasses(t),this.showCurrentScreen())}},{key:"updateStepper",value:function(t){this.quiz.dataset.quizPage=t,this.stepsNode&&(this.stepsNode.querySelector('[data-quiz-step="current"]').textContent=t)}},{key:"updateQuizStateClasses",value:function(t){1===t?(this.quiz.classList.remove("is-midterm-survey","is-last-quiz-step"),this.quiz.classList.add("is-first-quiz-step")):t===this.quizScreenCount?(this.quiz.classList.remove("is-first-quiz-step","is-midterm-survey"),this.quiz.classList.add("is-last-quiz-step")):(this.quiz.classList.remove("is-first-quiz-step","is-last-quiz-step"),this.quiz.classList.add("is-midterm-survey"))}},{key:"showCurrentScreen",value:function(){var t=this.quiz.dataset.quizPage,e=Array.from(this.screenNodes).find((function(e){return e.dataset.quizScreen===t}));this.screenNodes.forEach((function(t){return t.classList.remove("just-quiz__screen--current")})),e.classList.add("just-quiz__screen--current")}},{key:"initQuiz",value:function(){this.quiz&&this.initScreens()&&(this.initSteps(),this.initControls(),this.setScreen(this.options._startPage))}}]),t}();